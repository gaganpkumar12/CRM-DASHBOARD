<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OverAll CRM Analysis</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="sparkleFx" aria-hidden="true"></div>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="sidebar-brand">
        <span class="brand-title">Gclaw Command</span>
        <span class="brand-tag">Zoho CRM HQ</span>
      </div>
      <nav class="sidebar-nav">
        <a href="index.html" class="sidebar-link active">üè† Home</a>
        <a href="ai-insights.html" class="sidebar-link">ü§ñ AI Insights</a>
      </nav>
    </aside>

    <div class="main-column">
      <nav class="top-nav card">
        <div class="nav-title">Control Center</div>
        <div class="nav-links">
          <a href="index.html" class="nav-link active">Home</a>
          <a href="ai-insights.html" class="nav-link">AI Insights</a>
        </div>
      </nav>

      <div class="container">
        <header class="header card">
          <div>
            <h1>OverAll CRM Analysis</h1>
            <p>Read-only analytics from Zoho CRM (Today leads/deals/tasks)</p>
          </div>
          <div class="meta header-actions">
            <span id="lastUpdated">Last updated: --</span>
            <button id="manualRefreshBtn" class="refresh-btn" type="button">‚Üª Refresh</button>
          </div>
        </header>

        <section>
          <div class="card" style="margin-bottom:10px">
            <h3>CRM KPIs</h3>
            <p class="meta">Today's headline numbers from Zoho CRM ‚Äî leads, deals, tasks, and call stats at a glance.</p>
          </div>
          <div class="kpis" id="kpiGrid"></div>
        </section>

        <section>
          <div class="card" style="margin-bottom:10px">
            <h3>Category Lead ‚Üí Deal Conversion (7 Days)</h3>
            <p class="meta">Last 7 days including today ‚Äî breaks out how each service category is converting leads into deals so you can spot which offerings need attention.</p>
          </div>
          <div class="kpis" id="categoryConversionGrid"></div>
        </section>

        <section>
          <div class="card" style="margin-bottom:10px">
            <h3>Top Booking Areas</h3>
            <p class="meta">Top 5 areas by deal volume ‚Äî extracted from address fields across all deals. Pinpoints which localities drive the most bookings.</p>
          </div>
          <div class="kpis" id="topBookingAreasGrid"></div>
        </section>


        <section class="grid two-col">
          <article class="card">
            <h3>Today Retention Trend (Hourly, Real)</h3>
            <p class="meta">Tracks what percentage of today's leads have been contacted each hour. Spot engagement dips early so you can push mid-day call blitzes before leads go cold.</p>
            <canvas id="retentionChart"></canvas>
          </article>
          <article class="card">
            <h3>Call Duration (Avg Sec) & Volume</h3>
            <p class="meta">Overlays call count (bars) with average call duration (line) by hour. Helps you find when reps are making lots of short calls vs. fewer but deeper conversations.</p>
            <canvas id="callChart"></canvas>
          </article>
        </section>

        <section class="card">
          <h3 id="ncLadderTitle">NC Ladder Intelligence</h3>
          <p class="meta">Tracks how leads progress through Not-Connected stages (NC1 ‚Üí NC2 ‚Üí NC3). Use this to monitor follow-up velocity, spot SLA breaches, and find the ideal callback windows per stage.</p>
          <div class="kpis" id="ncLadderKpis"></div>
          <div class="grid two-col">
            <article class="card">
              <h4>NC Funnel (Cumulative)</h4>
              <p class="meta">Total leads that have ever reached each NC stage. Shows overall funnel volume and where most leads stall.</p>
              <canvas id="ncFunnelChart"></canvas>
            </article>
            <article class="card">
              <h4>NC Funnel (Direct Stage Counts)</h4>
              <p class="meta">Leads currently sitting at each NC stage right now. Reveals the real-time backlog waiting for follow-up at every step.</p>
              <canvas id="ncFunnelDirectChart"></canvas>
            </article>
          </div>
          <div class="grid one-col">
            <article class="card">
              <h4>Ideal Callback Time by Stage</h4>
              <p class="meta">Best hour-of-day to call back leads at each NC stage, scored by historical connect rates. Schedule retry cadences around these windows.</p>
              <div class="table-wrap">
                <table>
                  <thead>
                    <tr><th>Stage</th><th>Ideal Hour</th><th>Count</th><th>Score</th></tr>
                  </thead>
                  <tbody id="ncIdealStageBody"></tbody>
                </table>
              </div>
            </article>
          </div>
        </section>

        <section class="grid two-col">
          <article class="card">
            <h3>Latest Leads</h3>
            <p class="meta">Live feed of today's incoming leads with call status. Quickly scan for uncalled leads, ownership gaps, or status issues that need immediate action.</p>
            <div class="table-wrap leads-scroll">
              <table>
                <thead>
                  <tr>
                    <th>Name</th><th>Phone</th><th>Owner</th><th>Status</th><th>Sub Status</th><th>Called</th><th>Modified</th>
                  </tr>
                </thead>
                <tbody id="latestLeadsBody"></tbody>
              </table>
            </div>
          </article>
          <article class="card">
            <h3>Owner-wise Retention (Today)</h3>
            <p class="meta">Each rep's call-back rate on today's assigned leads. Low retention % means leads are sitting untouched ‚Äî use this to hold reps accountable.</p>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Lead Owner</th><th>Today's Leads</th><th>Called Leads</th><th>Retention %</th>
                  </tr>
                </thead>
                <tbody id="ownerRetentionBody"></tbody>
              </table>
            </div>
          </article>
        </section>

        <section class="grid one-col">
          <article class="card">
            <h3>Owner-wise Performance</h3>
            <p class="meta">Full rep scorecard ‚Äî lead volume, deal conversions, task completion, and retention side-by-side. Compare reps at a glance and spot who needs coaching.</p>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Lead Owner</th>
                    <th>Today Leads</th>
                    <th>Today Deals</th>
                    <th>Lead‚ÜíDeal %</th>
                    <th>Total Tasks</th>
                    <th>Completed Tasks</th>
                    <th>Task Completion %</th>
                    <th>Retention %</th>
                  </tr>
                </thead>
                <tbody id="ownerStatsBody"></tbody>
              </table>
            </div>
          </article>
        </section>
      </div>
    </div>
  </div>

  <!-- Fullscreen chart modal -->
  <div id="chartModal" class="chart-modal" hidden>
    <div class="chart-modal-backdrop"></div>
    <div class="chart-modal-content">
      <button class="chart-modal-close" type="button" aria-label="Close">‚úï</button>
      <canvas id="chartModalCanvas"></canvas>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
